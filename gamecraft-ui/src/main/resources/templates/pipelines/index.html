<!DOCTYPE HTML>

<html>
<head>
    <title>Gamecraft CI</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="/webjars/bootstrap/3.3.7-1/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/dashboard.css"/>
    <link rel="stylesheet" href="/css/pipelines.css"/>
    <script src="/webjars/jquery/1.11.1/jquery.min.js"></script>
    <script src="/webjars/jspdf/1.4.1/dist/jspdf.min.js"></script>
    <script  src="/webjars/jspdf/1.4.1/plugins/split_text_to_size.js"></script>
    <script src="/webjars/bootstrap/3.3.7-1/js/bootstrap.min.js"></script>
    <script src="/js/account_operations.js"></script>
    <script src="/js/projects_operations.js"></script>
    <script src="/js/report_operations.js"></script>
    <script src="/js/pipeline_operations.js"></script>
    <script src="/js/engines_operations.js"></script>
    <script src="/js/email_notifications_operations.js"></script>
    <script src="/js/irc_notifications_operations.js"></script>
    <script src="/js/slack_notifications_operations.js"></script>
    <script src="/js/telegram_notifications_operations.js"></script>
    <script src="/js/twitter_notifications_operations.js"></script>
    <script src="/js/ui_operations.js"></script>
    <script src="/js/validator.min.js"></script>
    <script src="/js/lang_operations.js"></script>
    <script>
        checkAuthState();
        loadNavbar();
        setDefaultLanguage();
        var projectId = findGetParameter('project_id');
        var project = getProject(projectId);
        var pipelineId;
        fillPipelinesTable(projectId);
        $(document).ready(function() {
            if (!isAdmin(getUsername())) {
                document.getElementById('createPipelineButton').style.visibility = 'hidden';
            }
            $('#reportsModal').on('show.bs.modal', function(e) {
                pipelineId = $(e.relatedTarget).data('pipeline-id');
                var reportSelect = document.getElementById("reportInstance");
                var reports = getReports();
                $("#reportInstance").empty();
                for(index in reports) {
                    reportSelect.options[reportSelect.options.length] = new Option('#' +  reports[index].id + ' ' + reports[index].reportDate + ' [' + reports[index].reportStatus +']', reports[index].id);
                }
                $("#reportBody").empty();
                document.getElementById("reportBody").value = getReport(reportSelect.options[reportSelect.selectedIndex].value).reportContent;
                $(document).on('change','#reportInstance',function(){
                    $("#reportBody").empty();
                    document.getElementById("reportBody").value = getReport(reportSelect.options[reportSelect.selectedIndex].value).reportContent;
                });

            });

            $('#createPipelineModal').on('show.bs.modal', function(e) {
                var engineSelect = document.getElementById("pipelineEngineName");
                var engines = getEngines();
                $("#pipelineEngineName").empty();
                if (getEngines().length == 0) {
                    alert("You cannot make new pipelines if there are no engines created.");
                    e.stop();
                }
                else {
                    for(index in engines) {
                        engineSelect.options[engineSelect.options.length] = new Option(engines[index].engineName, engines[index].id);
                    }
                    $(document).on('change','#pipelineEngineName',function(){
                        var engineSelect = document.getElementById("pipelineEngineName");
                        $(e.currentTarget).find('input[id="pipelineEngineCompilerPath"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerPath);
                        $(e.currentTarget).find('input[id="pipelineEngineCompilerArguments"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerArguments);

                    });
                    $(document).on('change','#pipelineScheduleType',function(){
                        var scheduleSelect = document.getElementById("pipelineScheduleType");
                        switch (scheduleSelect.options[scheduleSelect.selectedIndex].value) {
                            case "cronjob":
                                document.getElementById("pipelineScheduleCronjobLabel").style.display = 'block';
                                document.getElementById("pipelineScheduleCronjob").style.display = 'block';
                                document.getElementById('webhookMessage').innerHTML = '';
                                break;
                            case "webhook":
                                document.getElementById("pipelineScheduleCronjobLabel").style.display = 'none';
                                document.getElementById("pipelineScheduleCronjob").style.display = 'none';
                                document.getElementById('webhookMessage').innerHTML = 'If Webhook option is enabled, then you have to configure your Github repository so after a push is done in the repository, the pipeline endpoint will be fired. After you create the pipeline, you will know the endpoint to put in the Webhook settings from Github repository.';
                                break;
                        }

                    });

                    $(document).on('change','#pipelineNotificatorType',function(){
                        var notificatorTypeSelect = document.getElementById("pipelineNotificatorType");
                        var pipelineNotificatorName = document.getElementById("pipelineNotificatorName");
                        $("#pipelineNotificatorName").empty();
                        switch (notificatorTypeSelect.options[notificatorTypeSelect.selectedIndex].value) {
                            case "email":
                                var notificators = getEmailAccounts();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].emailAccountName, notificators[index].id);
                                }
                                break;
                            case "twitter":
                                var notificators = getTwitterBots();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].twitterBotName, notificators[index].id);
                                }
                                break;
                            case "telegram":
                                var notificators = getTelegramBots();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].telegramBotName, notificators[index].id);
                                }
                                break;
                            case "slack":
                                var notificators = getSlackAccounts();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].slackAccountName, notificators[index].id);
                                }
                                break;
                            case "irc":
                                var notificators = getIRCBots();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].ircBotName, notificators[index].id);
                                }
                                break;
                        }

                    });
                    var notificatorTypeSelect = document.getElementById("pipelineNotificatorType");
                    var pipelineNotificatorName = document.getElementById("pipelineNotificatorName");
                    $("#pipelineNotificatorName").empty();
                    switch (notificatorTypeSelect.options[notificatorTypeSelect.selectedIndex].value) {
                        case "email":
                            var notificators = getEmailAccounts();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].emailAccountName, notificators[index].id);
                            }
                            break;
                        case "twitter":
                            var notificators = getTwitterBots();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].twitterBotName, notificators[index].id);
                            }
                            break;
                        case "telegram":
                            var notificators = getTelegramBots();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].telegramBotName, notificators[index].id);
                            }
                            break;
                        case "slack":
                            var notificators = getSlackAccounts();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].slackAccountName, notificators[index].id);
                            }
                            break;
                        case "irc":
                            var notificators = getIRCBots();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].ircBotName, notificators[index].id);
                            }
                            break;
                    }
                    $(e.currentTarget).find('input[id="pipelineEngineCompilerPath"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerPath);
                    $(e.currentTarget).find('input[id="pipelineEngineCompilerArguments"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerArguments);
                }
            });

            $('#updatePipelineModal').on('show.bs.modal', function(e) {
                var engineSelect = document.getElementById("newpipelineEngineName");
                var engines = getEngines();
                $("#newpipelineEngineName").empty();
                if (getEngines().length == 0) {
                    alert("You cannot make new pipelines if there are no engines created.");
                    e.stop();
                }
                else {
                    for(index in engines) {
                        engineSelect.options[engineSelect.options.length] = new Option(engines[index].engineName, engines[index].id);
                    }
                    $(document).on('change','#newpipelineEngineName',function(){
                        var engineSelect = document.getElementById("newpipelineEngineName");
                        $(e.currentTarget).find('input[id="newpipelineEngineCompilerPath"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerPath);
                        $(e.currentTarget).find('input[id="newpipelineEngineCompilerArguments"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerArguments);

                    });
                    $(document).on('change','#newpipelineScheduleType',function(){
                        var scheduleSelect = document.getElementById("newpipelineScheduleType");
                        switch (scheduleSelect.options[scheduleSelect.selectedIndex].value) {
                            case "cronjob":
                                document.getElementById("newpipelineScheduleCronjobLabel").style.display = 'block';
                                document.getElementById("newpipelineScheduleCronjob").style.display = 'block';
                                document.getElementById('newwebhookMessage').innerHTML = '';
                                break;
                            case "webhook":
                                document.getElementById("newpipelineScheduleCronjobLabel").style.display = 'none';
                                document.getElementById("newpipelineScheduleCronjob").style.display = 'none';
                                document.getElementById('newwebhookMessage').innerHTML = 'Webhook pipeline enabled at '+ location.protocol + '//' + document.domain + ":8080/gamecraftpipelinemanager/api/pipelines/" + pipelineId + "/execute";
                                break;
                        }

                    });
                    $(document).on('change','#newpipelineNotificatorType',function(){
                        var notificatorTypeSelect = document.getElementById("newpipelineNotificatorType");
                        var pipelineNotificatorName = document.getElementById("newpipelineNotificatorName");
                        $("#newpipelineNotificatorName").empty();
                        switch (notificatorTypeSelect.options[notificatorTypeSelect.selectedIndex].value) {
                            case "email":
                                var notificators = getEmailAccounts();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].emailAccountName, notificators[index].id);
                                }
                                break;
                            case "twitter":
                                var notificators = getTwitterBots();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].twitterBotName, notificators[index].id);
                                }
                                break;
                            case "telegram":
                                var notificators = getTelegramBots();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].telegramBotName, notificators[index].id);
                                }
                                break;
                            case "slack":
                                var notificators = getSlackAccounts();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].slackAccountName, notificators[index].id);
                                }
                                break;
                            case "irc":
                                var notificators = getIRCBots();
                                for(index in notificators) {
                                    pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].ircBotName, notificators[index].id);
                                }
                                break;
                        }

                    });
                    var notificatorTypeSelect = document.getElementById("newpipelineNotificatorType");
                    var pipelineNotificatorName = document.getElementById("newpipelineNotificatorName");
                    $("#pipelineNotificatorName").empty();
                    switch (notificatorTypeSelect.options[notificatorTypeSelect.selectedIndex].value) {
                        case "email":
                            var notificators = getEmailAccounts();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].emailAccountName, notificators[index].id);
                            }
                            break;
                        case "twitter":
                            var notificators = getTwitterBots();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].twitterBotName, notificators[index].id);
                            }
                            break;
                        case "telegram":
                            var notificators = getTelegramBots();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].telegramBotName, notificators[index].id);
                            }
                            break;
                        case "slack":
                            var notificators = getSlackAccounts();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].slackAccountName, notificators[index].id);
                            }
                            break;
                        case "irc":
                            var notificators = getIRCBots();
                            for(index in notificators) {
                                pipelineNotificatorName.options[pipelineNotificatorName.options.length] = new Option(notificators[index].ircBotName, notificators[index].id);
                            }
                            break;
                    }
                    $(e.currentTarget).find('input[id="newpipelineEngineCompilerPath"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerPath);
                    $(e.currentTarget).find('input[id="newpipelineEngineCompilerArguments"]').val(getEngine(engineSelect.options[engineSelect.selectedIndex].value).engineCompilerArguments);


                }

                pipelineId = $(e.relatedTarget).data('pipeline-id');
                $(e.currentTarget).find('input[id="newpipelineName"]').val(getPipeline(pipelineId).pipelineName);
                $(e.currentTarget).find('input[id="newpipelineDescription"]').val(getPipeline(pipelineId).pipelineDescription);
                $(e.currentTarget).find('input[id="newpipelineRepositoryUsername"]').val(getPipeline(pipelineId).pipelineRepositoryUsername);
                $(e.currentTarget).find('input[id="newpipelineRepositoryPassword"]').val(getPipeline(pipelineId).pipelineRepositoryPassword);
                $(e.currentTarget).find('input[id="newpipelineRepositoryAddress"]').val(getPipeline(pipelineId).pipelineRepositoryAddress);
                $(e.currentTarget).find('input[id="newpipelineRepositoryBranch"]').val(getPipeline(pipelineId).pipelineRepositoryBranch);
                $(e.currentTarget).find('input[id="newpipelineEngineCompilerPath"]').val(getPipeline(pipelineId).pipelineEngineCompilerPath);
                $(e.currentTarget).find('input[id="newpipelineEngineCompilerArguments"]').val(getPipeline(pipelineId).pipelineEngineCompilerArguments);
                $(e.currentTarget).find('input[id="newpipelineNotificatorRecipient"]').val(getPipeline(pipelineId).pipelineNotificatorRecipient);
                $(e.currentTarget).find('input[id="newpipelineFtpAddress"]').val(getPipeline(pipelineId).pipelineFtpAddress);
                $(e.currentTarget).find('input[id="newpipelineFtpPort"]').val(getPipeline(pipelineId).pipelineFtpPort);
                $(e.currentTarget).find('input[id="newpipelineFtpUsername"]').val(getPipeline(pipelineId).pipelineFtpUsername);
                $(e.currentTarget).find('input[id="newpipelineFtpPassword"]').val(getPipeline(pipelineId).pipelineFtpPassword);
                $(e.currentTarget).find('input[id="newpipelineDropboxAppKey"]').val(getPipeline(pipelineId).pipelineDropboxAppKey);
                $(e.currentTarget).find('input[id="newpipelineDropboxToken"]').val(getPipeline(pipelineId).pipelineDropboxToken);
                $(e.currentTarget).find('select[id="newpipelineNotificatorType"]').val(getPipeline(pipelineId).pipelineNotificatorType.toLowerCase());
                $(e.currentTarget).find('select[id="newpipelineScheduleType"]').val(getPipeline(pipelineId).pipelineScheduleType.toLowerCase());
                $(e.currentTarget).find('input[id="newpipelineScheduleCronjob"]').val(getPipeline(pipelineId).pipelineScheduleCronJob);
                var scheduleSelect = document.getElementById("newpipelineScheduleType");
                switch (scheduleSelect.options[scheduleSelect.selectedIndex].value) {
                    case "cronjob":
                        document.getElementById("newpipelineScheduleCronjobLabel").style.display = 'block';
                        document.getElementById("newpipelineScheduleCronjob").style.display = 'block';
                        document.getElementById('newwebhookMessage').innerHTML = '';
                        break;
                    case "webhook":
                        document.getElementById("newpipelineScheduleCronjobLabel").style.display = 'none';
                        document.getElementById("newpipelineScheduleCronjob").style.display = 'none';
                        document.getElementById('newwebhookMessage').innerHTML = 'Webhook pipeline enabled at '+ location.protocol + '//' + document.domain + ":8080/gamecraftpipelinemanager/api/pipelines/" + pipelineId + "/execute";
                        break;
                }

            });
        });
    </script>
</head>
<body>
<div class="navbar-frame"></div>
<div class="container">

    <h1>Pipelines</h1>
    <h2><script>document.write(project.projectName)</script></h2>
    <table class="table table-hover">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
            <th>Operations</th>
        </tr>
    </table>
    <button type="button" id="createPipelineButton" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#createPipelineModal"><span class="glyphicon glyphicon-plus"></span> Create new pipeline</button>
</div> <!-- /container -->

<div class="modal fade" id="createPipelineModal" tabindex="-1" role="dialog" aria-labelledby="createPipelineModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Create new pipeline</h4>
            </div>
            <div class="modal-body">
                <form role="form" data-toggle="validator" name="form" id="form" class="form-horizontal"
                      enctype="multipart/form-data">
                    <div class="panel panel-default">
                        <!-- Default panel contents -->
                        <div class="panel-heading">Pipeline Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineName">Pipeline name:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineName" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineDescription">Pipeline description:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineDescription" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Repository Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineRepositoryUsername">Github Repository Username:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineRepositoryUsername" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineRepositoryPassword">Github Repository Password:</label>
                                    <input type="password" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineRepositoryPassword" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineRepositoryAddress">Github Repository Address:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineRepositoryAddress" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineRepositoryBranch">Github Repository Branch:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineRepositoryBranch" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Compilation Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineEngineName">Engine name:</label>
                                    <select class="form-control" id="pipelineEngineName" required="true"></select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineEngineCompilerPath">Engine Compiler Path:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineEngineCompilerPath" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineEngineCompilerArguments">Engine Compiler Arguments:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineEngineCompilerArguments" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">FTP Publication Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineFtpAddress">FTP Address:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineFtpAddress" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineFtpPort">FTP Port:</label>
                                    <input type="number" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineFtpPort" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineFtpUsername">FTP Username:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineFtpUsername" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineFtpPassword">FTP Password:</label>
                                    <input type="password" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineFtpPassword" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Dropbox Publication Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineDropboxAppKey">Dropbox App Key:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineDropboxAppKey" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineDropboxToken">Dropbox Token:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineDropboxToken" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Notification Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineNotificatorType">Notificator Type:</label>
                                    <select class="form-control" id="pipelineNotificatorType" required="true">
                                        <option value="email">E-mail</option>
                                        <option value="twitter">Twitter</option>
                                        <option value="telegram">Telegram</option>
                                        <option value="slack">Slack</option>
                                        <option value="irc">IRC</option>
                                    </select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineNotificatorName">Notificator name:</label>
                                    <select class="form-control" id="pipelineNotificatorName" required="true"></select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineNotificatorRecipient">Notificator recipient:</label>
                                    <input type="text" class="form-control" id="pipelineNotificatorRecipient" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Scheduling Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineScheduleType">Schedule Type:</label>
                                    <select class="form-control" id="pipelineScheduleType" required="true">
                                        <option value="cronjob">Cron Job</option>
                                        <option value="webhook">WebHook</option>
                                    </select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineScheduleCronjob" id="pipelineScheduleCronjobLabel">Schedule Cronjob:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="pipelineScheduleCronjob" required="true"/>
                                    <p id="webhookMessage"></p>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" onclick="
                switch (pipelineNotificatorType.value) {
                    case 'email':
                        if (pipelineScheduleType.value == 'cronjob')
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'EMAIL',getEmailAccount(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,pipelineScheduleCronjob.value,'CRONJOB',pipelineNotificatorRecipient.value);
                        else
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'EMAIL',getEmailAccount(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,null,'WEBHOOK',pipelineNotificatorRecipient.value);
                    break;
                    case 'twitter':
                    if (pipelineScheduleType.value == 'cronjob')
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'TWITTER',getTwitterBot(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,pipelineScheduleCronjob.value,'CRONJOB',pipelineNotificatorRecipient.value);
                        else
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'TWITTER',getTwitterBot(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,null,'WEBHOOK',pipelineNotificatorRecipient.value);                    break;
                    case 'telegram':
                    if (pipelineScheduleType.value == 'cronjob')
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'TELEGRAM',getTelegramBot(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,pipelineScheduleCronjob.value,'CRONJOB',pipelineNotificatorRecipient.value);
                        else
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'TELEGRAM',getTelegramBot(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,null,'WEBHOOK',pipelineNotificatorRecipient.value);                    break;
                    case 'slack':
                    if (pipelineScheduleType.value == 'cronjob')
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'SLACK',getSlackAccount(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,pipelineScheduleCronjob.value,'CRONJOB',pipelineNotificatorRecipient.value);
                        else
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'SLACK',getSlackAccount(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,null,'WEBHOOK',pipelineNotificatorRecipient.value);                    break;
                    case 'irc':
                        if (pipelineScheduleType.value == 'cronjob')
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'IRC',getIRCBot(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,pipelineScheduleCronjob.value,'CRONJOB',pipelineNotificatorRecipient.value);
                        else
                            addPipeline(pipelineName.value,pipelineDescription.value,projectId,project.projectName,pipelineDropboxAppKey.value,pipelineDropboxToken.value,pipelineEngineCompilerPath.value,pipelineEngineCompilerArguments.value,pipelineFtpAddress.value,pipelineFtpUsername.value,pipelineFtpPassword.value,pipelineFtpPort.value,'IRC',getIRCBot(pipelineNotificatorName.value).id,null,pipelineRepositoryAddress.value,pipelineRepositoryPassword.value,'GITHUB',pipelineRepositoryUsername.value,pipelineRepositoryBranch.value,null,'WEBHOOK',pipelineNotificatorRecipient.value);                    break;
                }

                 location.reload();" class="btn btn-primary"><i class="glyphicon glyphicon glyphicon-floppy-disk"></i>Save changes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="updatePipelineModal" tabindex="-1" role="dialog" aria-labelledby="updatePipelineModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Update pipeline</h4>
            </div>
            <div class="modal-body">
                <form role="form" data-toggle="validator" name="form" id="newform" class="form-horizontal"
                      enctype="multipart/form-data">
                    <div class="panel panel-default">
                        <!-- Default panel contents -->
                        <div class="panel-heading">Pipeline Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineName">Pipeline name:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineName" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineDescription">Pipeline description:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineDescription" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Repository Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineRepositoryUsername">Github Repository Username:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineRepositoryUsername" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineRepositoryPassword">Github Repository Password:</label>
                                    <input type="password" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineRepositoryPassword" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineRepositoryAddress">Github Repository Address:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineRepositoryAddress" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineRepositoryBranch">Github Repository Branch:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineRepositoryBranch" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Compilation Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineEngineName">Engine name:</label>
                                    <select class="form-control" id="newpipelineEngineName" required="true"></select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineEngineCompilerPath">Engine Compiler Path:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineEngineCompilerPath" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineEngineCompilerArguments">Engine Compiler Arguments:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineEngineCompilerArguments" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">FTP Publication Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineFtpAddress">FTP Address:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineFtpAddress" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineFtpPort">FTP Port:</label>
                                    <input type="number" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineFtpPort" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineFtpUsername">FTP Username:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineFtpUsername" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineFtpPassword">FTP Password:</label>
                                    <input type="password" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineFtpPassword" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Dropbox Publication Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineDropboxAppKey">Dropbox App Key:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineDropboxAppKey" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineDropboxToken">Dropbox Token:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineDropboxToken" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Notification Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineNotificatorType">Notificator Type:</label>
                                    <select class="form-control" id="newpipelineNotificatorType" required="true">
                                        <option value="email">E-mail</option>
                                        <option value="twitter">Twitter</option>
                                        <option value="telegram">Telegram</option>
                                        <option value="slack">Slack</option>
                                        <option value="irc">IRC</option>
                                    </select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineNotificatorName">Notificator name:</label>
                                    <select class="form-control" id="newpipelineNotificatorName" required="true"></select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineNotificatorRecipient">Notificator recipient:</label>
                                    <input type="text" class="form-control" id="newpipelineNotificatorRecipient" required="true"/>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="panel-heading">Scheduling Settings</div>
                        <div class="panel-body">
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="newpipelineScheduleType">Schedule Type:</label>
                                    <select class="form-control" id="newpipelineScheduleType" required="true">
                                        <option value="cronjob">Cron Job</option>
                                        <option value="webhook">WebHook</option>
                                    </select>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                            <div class="form-group has-feedback form-group-lg">
                                <div class="input-group">
                                    <label for="pipelineScheduleCronjob" id="newpipelineScheduleCronjobLabel">Schedule Cronjob:</label>
                                    <input type="text" pattern="^[_A-z0-9]{1,}$" class="form-control" id="newpipelineScheduleCronjob" required="true"/>
                                    <p id="newwebhookMessage"></p>
                                </div>
                                <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" onclick="
                switch (newpipelineNotificatorType.value) {
                    case 'email':
                        if (newpipelineScheduleType.value == 'cronjob')
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'EMAIL',JSON.stringify(getEmailAccount(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,newpipelineScheduleCronjob.value,'CRONJOB','IDLE',newpipelineNotificatorRecipient.value);
                        else
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'EMAIL',JSON.stringify(getEmailAccount(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,null,'WEBHOOK','IDLE',newpipelineNotificatorRecipient.value);
                    break;
                    case 'twitter':
                    if (newpipelineScheduleType.value == 'cronjob')
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'TWITTER',JSON.stringify(getTwitterBot(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,newpipelineScheduleCronjob.value,'CRONJOB','IDLE',newpipelineNotificatorRecipient.value);
                        else
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'TWITTER',JSON.stringify(getTwitterBot(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,null,'WEBHOOK','IDLE',newpipelineNotificatorRecipient.value);                    break;
                    case 'telegram':
                    if (newpipelineScheduleType.value == 'cronjob')
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'TELEGRAM',JSON.stringify(getTelegramBot(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,newpipelineScheduleCronjob.value,'CRONJOB','IDLE',newpipelineNotificatorRecipient.value);
                        else
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'TELEGRAM',JSON.stringify(getTelegramBot(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,null,'WEBHOOK','IDLE',newpipelineNotificatorRecipient.value);                    break;
                    case 'slack':
                    if (newpipelineScheduleType.value == 'cronjob')
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'SLACK',JSON.stringify(getSlackAccount(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,newpipelineScheduleCronjob.value,'CRONJOB','IDLE',newpipelineNotificatorRecipient.value);
                        else
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'SLACK',JSON.stringify(getSlackAccount(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,null,'WEBHOOK','IDLE',newpipelineNotificatorRecipient.value);                    break;
                    case 'irc':
                        if (newpipelineScheduleType.value == 'cronjob')
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'IRC',JSON.stringify(getIRCBot(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,newpipelineScheduleCronjob.value,'CRONJOB','IDLE',newpipelineNotificatorRecipient.value);
                        else
                            updatePipeline(pipelineId,newpipelineName.value,newpipelineDescription.value,projectId,project.projectName,newpipelineDropboxAppKey.value,newpipelineDropboxToken.value,newpipelineEngineCompilerPath.value,newpipelineEngineCompilerArguments.value,newpipelineFtpAddress.value,newpipelineFtpUsername.value,newpipelineFtpPassword.value,newpipelineFtpPort.value,'IRC',JSON.stringify(getIRCBot(newpipelineNotificatorName.value).id),null,newpipelineRepositoryAddress.value,newpipelineRepositoryPassword.value,'GITHUB',newpipelineRepositoryUsername.value,newpipelineRepositoryBranch.value,null,'WEBHOOK','IDLE',newpipelineNotificatorRecipient.value);                    break;
                }

                 location.reload();" class="btn btn-primary"><i class="glyphicon glyphicon glyphicon-floppy-disk"></i>Save changes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="reportsModal" tabindex="-1" role="dialog" aria-labelledby="reportsModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Reports</h4>
            </div>
            <div class="modal-body">
                <form role="form" data-toggle="validator" name="form" id="reportsform" class="form-horizontal"
                      enctype="multipart/form-data">
                    <div class="form-group has-feedback form-group-lg">
                        <div class="input-group">
                            <label for="reportInstance">Report Instance:</label>
                            <select class="form-control" id="reportInstance" required="true"></select>
                        </div>
                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                    </div>
                    <div class="form-group has-feedback form-group-lg">
                        <div class="input-group">
                            <label for="reportBody">Report Body:</label>
                            <textarea class="span6" id="reportBody" rows="8" cols="76" readonly="true"></textarea>
                        </div>
                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" onclick="var doc = new jsPDF();
                var lines =doc.splitTextToSize(document.getElementById('reportBody').value, (210-15-15));
                doc.text( 15,20,lines  );
                doc.save('report.pdf');" class="btn btn-primary"><i class="glyphicon glyphicon glyphicon-floppy-disk"></i>Download as PDF</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>